(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/miaosha/goods/goods"],{1596:function(t,e,n){"use strict";n.r(e);var o=n("3f54"),i=n("329b");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("d3a4");var r=n("2877"),s=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,"52c2d5de",null);e["default"]=s.exports},"329b":function(t,e,n){"use strict";n.r(e);var o=n("a025"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);e["default"]=i.a},"3f54":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=(t._self._c,Number(110));t.$mp.data=Object.assign({},{$root:{m0:n}})},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})},a025:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("a34a")),i=n("2f62");function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n,o,i,a,r){try{var s=t[a](r),p=s.value}catch(u){return void n(u)}s.done?e(p):Promise.resolve(p).then(o,i)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var a=t.apply(e,n);function s(t){r(a,o,i,s,p,"next",t)}function p(t){r(a,o,i,s,p,"throw",t)}s(void 0)})}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(n,!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(){return Promise.all([n.e("common/vendor"),n.e("components/page-component/goods/app-goods-banner")]).then(n.bind(null,"12b6"))},l=function(){return n.e("plugins/miaosha/components/app-goods-time").then(n.bind(null,"89a5"))},m=function(){return n.e("plugins/miaosha/components/app-merchant-guarantee").then(n.bind(null,"067f"))},h=function(){return n.e("plugins/miaosha/components/app-price-title-share").then(n.bind(null,"8c55"))},f=function(){return Promise.all([n.e("common/vendor"),n.e("components/page-component/app-attr/app-attr")]).then(n.bind(null,"d3c4"))},g=function(){return n.e("components/page-component/goods/app-goods-attr").then(n.bind(null,"9dc1"))},_=function(){return n.e("components/page-component/app-related-suggestion-product/app-related-suggestion-product").then(n.bind(null,"1ce4"))},b=function(){return Promise.all([n.e("common/vendor"),n.e("components/page-component/goods/app-goods-service")]).then(n.bind(null,"311c"))},v=function(){return Promise.all([n.e("common/vendor"),n.e("components/page-component/goods/app-goods-marketing")]).then(n.bind(null,"1143"))},y=function(){return n.e("components/page-component/app-join-member/app-join-member").then(n.bind(null,"40f4"))},w=function(){return n.e("components/page-component/goods/app-goods-detail").then(n.bind(null,"5abf"))},O=function(){return n.e("components/page-component/app-iphonex-bottom/app-iphonex-bottom").then(n.bind(null,"bc3b"))},P=function(){return Promise.all([n.e("common/vendor"),n.e("components/basic-component/app-iphone-x/app-iphone-x")]).then(n.bind(null,"7598"))},j=function(){return Promise.all([n.e("common/vendor"),n.e("components/basic-component/app-empty-bottom/app-empty-bottom")]).then(n.bind(null,"0c06"))},A=function(){return Promise.all([n.e("common/vendor"),n.e("components/page-component/app-vip-card/app-vip-card")]).then(n.bind(null,"19f0"))},$={name:"goods",data:function(){return{detail:{},cartShow:!1,miaosha_status:-1,miaosha_time:0,selectAttr:{},previewUrl:this.$api.miaosha.order_preview,submitUrl:this.$api.miaosha.order_submit,url:"",show:!1,list:[],miaosha_buy_count:0,appAttr:{},goods_id:-1,hour:0,minute:0,second:0,day:0,time:-1,is_vip_card_user:0,discount:null,is_vip:!1,loading:!1}},onLoad:function(t){this.goods_id=t.id},onShow:function(){var t=this;this.$nextTick(function(){var e=t;t.request({url:t.$api.miaosha.goods_detail,data:{id:t.goods_id}}).then(function(n){var o=n.detail,i=n.miaosha_status,a=n.miaosha_time,r=n.miaosha_buy_count;t.detail=o,t.miaosha_status=i,t.miaosha_buy_count=r,t.loading=!0,t.url="".concat(t.$api.miaosha.poster,"&goods_id=").concat(t.detail.id),t.getTime(a),t.request({url:t.$api.goods.new_recommend,data:{goods_id:t.detail.id}}).then(function(n){t.list=n.list,e.detail.vip_card_appoint.discount>0&&(e.is_vip=!0,e.discount=e.detail.vip_card_appoint.discount),e.is_vip_card_user=e.detail.vip_card_appoint.is_vip_card_user})})})},onHide:function(){clearInterval(this.time)},onUnload:function(){clearInterval(this.time)},computed:u({},(0,i.mapState)("gConfig",{iphone:function(t){return t.iphone},iphoneHeight:function(t){return t.iphoneHeight}}),{},(0,i.mapState)({mall:function(t){return t.mallConfig.mall}})),onShareAppMessage:function(){return this.$shareAppMessage({path:"/plugins/miaosha/goods/goods",title:this.detail.app_share_title?this.detail.app_share_title:this.detail.name,imageUrl:this.detail.app_share_pic?this.detail.app_share_pic:"",params:{id:this.detail.id}})},methods:{attr:function(t){this.appAttr=t},request:function(){var t=s(o.default.mark(function t(e){var n,i,a;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.url,i=e.data,t.next=3,this.$request({url:n,data:i});case 3:if(a=t.sent,0!==a.code){t.next=6;break}return t.abrupt("return",a.data);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),attrtap:function(t){this.selectAttr=null!==t?t:{}},joinCart:function(){var t=this;"none"===this.appAttr.display?this.show=Math.random():this.$request({url:this.$api.miaosha.add_cart,method:"post",data:{miaosha_goods_id:this.selectAttr.goods_id,attr_id:this.selectAttr.id,num:this.appAttr.number}}).then(function(e){0===e.code&&(t.appAttr.display="none")})},buy:function(){if("none"===this.appAttr.display)this.show=Math.random();else{for(var t=this.detail.mch_id,e=[],n={id:this.detail.id,attr:[],num:this.appAttr.number,goods_attr_id:this.selectAttr.id,cart_id:0},o=0;o<this.selectAttr.attr_list.length;o++){var i={attr_id:this.selectAttr.attr_list[o].attr_id,attr_group_id:this.selectAttr.attr_list[o].attr_group_id};n.attr.push(i)}e.push({mch_id:t,goods_list:[n]}),this.$jump({open_type:"navigate",url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify(e),"&preview_url=").concat(encodeURIComponent(this.$api.miaosha.order_preview),"&submit_url=").concat(encodeURIComponent(this.$api.miaosha.order_submit))})}},getTime:function(t){var e=this;t-=1,this.day=parseInt(t/3600/24),this.hour=parseInt(t/3600%24),this.minute=parseInt(t/60%60),this.second=parseInt(t%60),clearInterval(this.time),this.time=setInterval(function(){t-=1,t<0&&clearInterval(e.time),e.day=parseInt(t/3600/24),e.hour=parseInt(t/3600%24),e.minute=parseInt(t/60%60),e.second=parseInt(t%60)},1e3)}},components:{"app-banner":d,"app-goods-time":l,"app-merchant-guarantee":m,"app-price-title-share":h,"app-attr":f,"app-goods-attr":g,"app-related-suggestion-product":_,"app-goods-service":b,"app-goods-marketing":v,"app-join-member":y,"app-goods-detail":w,"app-iphone-bottom":O,"app-iphone-x":P,"app-empty-bottom":j,"app-vip-card":A}};e.default=$},c897:function(t,e,n){},d3a4:function(t,e,n){"use strict";var o=n("c897"),i=n.n(o);i.a}},[["5baa","common/runtime","common/vendor"]]]);