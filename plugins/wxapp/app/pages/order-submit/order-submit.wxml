<app-layout vue-id="1" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default']}}"><block wx:if="{{previewData}}"><view class="page data-v-3a558e4c"><block wx:if="{{previewData.show_address!==false}}"><block wx:if="{{previewData.allZiti}}"><view class="address data-v-3a558e4c"><app-order-submit-row vue-id="{{('2')+','+('1')}}" show-nav="{{false}}" no-padding="{{true}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default','footer']}}"><view class="dir-left-nowrap px-12 data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c"><app-input bind:input="__e" vue-id="{{('3')+','+('2')}}" placeholder="请填写联系人" height="100" value="{{previewData.address.name}}" data-event-opts="{{[['^input',[['__set_model',['$0','name','$event',[]],['previewData.address']]]]]}}" class="data-v-3a558e4c" bind:__l="__l"></app-input></view><view class="box-grow-1 data-v-3a558e4c"><app-input bind:input="__e" vue-id="{{('4')+','+('2')}}" placeholder="请填写手机号" height="100" value="{{previewData.address.mobile}}" data-event-opts="{{[['^input',[['__set_model',['$0','mobile','$event',[]],['previewData.address']]]]]}}" class="data-v-3a558e4c" bind:__l="__l"></app-input></view></view><view slot="footer" class="data-v-3a558e4c"><image class="bottom-image data-v-3a558e4c" src="{{appImg.common.address_bottom}}"></image></view></app-order-submit-row></view></block><block wx:else><view data-event-opts="{{[['tap',[['navigateAddress',['$event']]]]]}}" class="address data-v-3a558e4c" bindtap="__e"><app-order-submit-row vue-id="{{('5')+','+('1')}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default','footer']}}"><block wx:if="{{previewData.address}}"><view class="data-v-3a558e4c"><view class="dir-left-nowrap mb-12 data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c">{{"收货人: "+previewData.address.name}}</view><view class="box-grow-0 data-v-3a558e4c">{{previewData.address.mobile}}</view></view><view class="mb-12 data-v-3a558e4c">{{'收货地址:\n                            '+previewData.address.province+"\n                            "+previewData.address.city+"\n                            "+previewData.address.district+"\n                            "+previewData.address.detail+''}}</view></view></block><block wx:else><view class="data-v-3a558e4c">请选择收货地址</view></block><block wx:if="{{previewData.has_ziti}}"><view class="{{['ziti-tip data-v-3a558e4c',theme+'-color']}}">(收货地址中的手机号码将用于自提信息)</view></block><view slot="footer" class="data-v-3a558e4c"><image class="bottom-image data-v-3a558e4c" src="{{appImg.common.address_bottom}}"></image></view></app-order-submit-row></view></block></block><view class="mch-list data-v-3a558e4c"><block wx:for="{{previewData.mch_list}}" wx:for-item="mch" wx:for-index="mchIndex" wx:key="mchIndex"><view class="mch-item data-v-3a558e4c"><view class="mch-name data-v-3a558e4c">{{mch.mch.name}}</view><block wx:if="{{mch.show_delivery!==false}}"><view class="dir-left-nowrap cross-center delivery data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c">配送方式</view><view class="box-grow-0 data-v-3a558e4c"><block wx:for="{{mch.delivery.send_type_list}}" wx:for-item="sendType" wx:for-index="sendTypeIndex" wx:key="sendTypeIndex"><view data-event-opts="{{[['tap',[['changeSendType',[mchIndex,'$0'],[[['previewData.mch_list','',mchIndex],['delivery.send_type_list','',sendTypeIndex,'value']]]]]]]}}" class="{{['send-type data-v-3a558e4c',sendType.value==mch.delivery.send_type?theme+'-background':'weak-two-background']}}" bindtap="__e">{{''+sendType.name+''}}</view></block></view></view></block><block wx:if="{{!mch.pick_up_enable}}"><view class="pick-up cross-center data-v-3a558e4c"><view class="data-v-3a558e4c">{{"以下商品满"+mch.pick_up_price+"元起送"}}</view></view></block><block wx:if="{{mch.delivery.send_type=='offline'}}"><view class="store data-v-3a558e4c"><block wx:if="{{mch.no_store&&mch.no_store===true}}"><app-order-submit-row vue-id="{{('6-'+mchIndex)+','+('1')}}" show-nav="{{false}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default']}}">暂无门店，请选择其他配送方式</app-order-submit-row></block><block wx:else><app-order-submit-row vue-id="{{('7-'+mchIndex)+','+('1')}}" show-nav="{{mch.mch.id==0}}" data-event-opts="{{[['^click',[['navigateStore',[mchIndex]]]]]}}" bind:click="__e" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default','header']}}"><view class="title data-v-3a558e4c" slot="header">门店信息</view><block wx:if="{{mch.store}}"><view class="dir-left-nowrap mb-12 data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c">{{mch.store.name}}</view><view class="box-grow-0 location data-v-3a558e4c"><image class="icon data-v-3a558e4c" src="/static/image/icon/location.png"></image><block wx:if="{{getLocationFail}}"><view class="inline-block data-v-3a558e4c"><view class="inline-block data-v-3a558e4c">定位失败</view><view data-event-opts="{{[['tap',[['openLocationSetting',['$event']]]]]}}" class="inline-block open-location-setting data-v-3a558e4c" catchtap="__e"><view class="{{['open-location-btn data-v-3a558e4c',theme+'-color',theme+'-border']}}">获取位置</view></view></view></block><block wx:else><view class="inline-block data-v-3a558e4c">{{"距离您"+mch.store.distance}}</view></block></view></view><view class="store-address data-v-3a558e4c">{{mch.store.address}}</view></block><block wx:else><view class="data-v-3a558e4c">请选择门店</view></block></app-order-submit-row></block></view></block><block wx:else><block wx:if="{{mch.delivery.send_type=='city'&&mch.city}}"><view class="city data-v-3a558e4c"><block wx:if="{{mch.city.error}}"><view class="dir-left-nowrap cross-center data-v-3a558e4c"><view class="box-grow-1 t-omit error data-v-3a558e4c">{{mch.city.error}}</view><view data-event-opts="{{[['tap',[['jump',[mchIndex]]]]]}}" class="box-grow-0 btn data-v-3a558e4c" bindtap="__e">查看配送范围</view></view></block><block wx:else><view class="t-omit data-v-3a558e4c">{{"发货地址："+mch.city.address}}</view><block wx:if="{{mch.city.explain}}"><view class="t-omit data-v-3a558e4c">{{mch.city.explain}}</view></block><view class="dir-left-nowrap cross-center data-v-3a558e4c"><view class="box-grow-1 t-omit error data-v-3a558e4c" style="color:#353535;">该地址在配送范围内</view><view data-event-opts="{{[['tap',[['jump',[mchIndex]]]]]}}" class="box-grow-0 btn data-v-3a558e4c" bindtap="__e">查看配送范围</view></view></block></view></block></block><app-submit-goods vue-id="{{('8-'+mchIndex)+','+('1')}}" index="{{mchIndex}}" plugin="{{plugin}}" list="{{mch}}" data-event-opts="{{[['^updateList',[['updateList']]]]}}" bind:updateList="__e" class="data-v-3a558e4c" bind:__l="__l"></app-submit-goods><block wx:if="{{mch.insert_rows&&mch.insert_rows.length}}"><block wx:for="{{mch.insert_rows}}" wx:for-item="insertRow" wx:for-index="insertRowIndex" wx:key="insertRowIndex"><view class="data-v-3a558e4c"><app-order-submit-row vue-id="{{('9-'+mchIndex+'-'+insertRowIndex)+','+('1')}}" show-nav="{{false}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default']}}"><view class="dir-left-nowrap data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c">{{insertRow.title}}</view><view class="{{['box-grow-0 data-v-3a558e4c',theme+'-color']}}">{{insertRow.value}}</view></view></app-order-submit-row></view></block></block><block wx:if="{{mch.coupon&&mch.coupon.enabled}}"><view data-event-opts="{{[['tap',[['navigateCoupon',[mchIndex]]]]]}}" class="coupon data-v-3a558e4c" bindtap="__e"><app-order-submit-row vue-id="{{('10-'+mchIndex)+','+('1')}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default']}}"><view class="dir-left-nowrap data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c">优惠券</view><block wx:if="{{mch.coupon.use}}"><view class="{{['box-grow-0 data-v-3a558e4c',theme+'-color']}}">{{'已优惠'+mch.coupon.coupon_discount+'元'}}</view></block><block wx:else><view class="box-grow-0 tip data-v-3a558e4c">选择优惠券</view></block></view></app-order-submit-row></view></block><block wx:if="{{mch.integral&&mch.integral.can_use}}"><view class="integral data-v-3a558e4c"><app-order-submit-row vue-id="{{('11-'+mchIndex)+','+('1')}}" show-nav="{{false}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default']}}"><view class="dir-left-nowrap data-v-3a558e4c"><view class="box-grow-1 dir-left-nowrap data-v-3a558e4c"><view class="data-v-3a558e4c">{{'使用\n                                    '+mch.integral.use_num+'\n                                    积分抵扣'}}<text class="{{['data-v-3a558e4c',theme+'-color']}}">{{mch.integral.deduction_price}}</text>元</view><view data-event-opts="{{[['tap',[['showIntegralTip',['$event']]]]]}}" class="tip-btn data-v-3a558e4c" bindtap="__e"><image class="icon data-v-3a558e4c" src="/static/image/icon/warning.png"></image></view></view><view class="box-grow-0 data-v-3a558e4c"><app-radio vue-id="{{('12-'+mchIndex)+','+('11-'+mchIndex)}}" type="round" value="{{mch.integral.use}}" theme="{{theme}}" data-event-opts="{{[['^input',[['changeIntegral',[mchIndex]]]]]}}" bind:input="__e" class="data-v-3a558e4c" bind:__l="__l"></app-radio></view></view></app-order-submit-row></view></block><block wx:if="{{mch.show_express_price!==false}}"><view class="data-v-3a558e4c"><app-order-submit-row vue-id="{{('13-'+mchIndex)+','+('1')}}" show-nav="{{false}}" showBorder="{{false}}" class="data-v-3a558e4c" bind:__l="__l" vue-slots="{{['default']}}"><view class="dir-left-nowrap data-v-3a558e4c"><view class="box-grow-1 data-v-3a558e4c">运费</view><view class="{{['box-grow-0 express-price data-v-3a558e4c',theme+'-color']}}"><block wx:if="{{mch.express_price_origin&&mch.express_price_desc}}"><view class="data-v-3a558e4c">{{"￥"+mch.express_price_origin+"元"}}</view><view class="express-price-desc data-v-3a558e4c">{{mch.express_price_desc+''}}</view></block><block wx:else><view class="data-v-3a558e4c">{{"￥"+mch.express_price+"元"}}</view></block></view></view></app-order-submit-row></view></block><block wx:if="{{mch.order_form&&mch.order_form.status=='1'}}"><view class="data-v-3a558e4c"><app-diy-form vue-id="{{('14-'+mchIndex)+','+('1')}}" title="{{mch.order_form.name}}" list="{{mch.order_form.value}}" sign="{{mchIndex}}" label-position="top" show-scroll-btn="{{mch.order_form.show_scroll}}" data-event-opts="{{[['^input',[['handleOrderFormInput']]],['^validate',[['handleOrderFormValidate']]]]}}" bind:input="__e" bind:validate="__e" class="data-v-3a558e4c" bind:__l="__l"></app-diy-form></view></block><block wx:else><block wx:if="{{mch.show_remark!==false&&mch.has_goods_form!==true}}"><view class="remark data-v-3a558e4c"><app-input vue-id="{{('15-'+mchIndex)+','+('1')}}" placeholder="买家留言" height="100" value="{{mch.remark}}" data-event-opts="{{[['^input',[['__set_model',['$0','remark','$event',[]],[[['previewData.mch_list','',mchIndex]]]],['inputRemark',[mchIndex]]]]]}}" bind:input="__e" class="data-v-3a558e4c" bind:__l="__l"></app-input></view></block></block><block wx:if="{{mch.has_goods_form}}"><block wx:for="{{mch.goods_list}}" wx:for-item="goodsItem" wx:for-index="goodsIndex" wx:key="goodsIndex"><block wx:if="{{goodsItem.form&&!goodsItem.form.same_form}}"><view style="margin-bottom:20rpx;" class="data-v-3a558e4c"><view style="padding:24rpx;color:#666666;" class="data-v-3a558e4c">{{goodsItem.form.name}}</view><block wx:if="{{mch.diff_goods_form_count!==1}}"><view class="goods-list data-v-3a558e4c"><block wx:for="{{mch.goods_list}}" wx:for-item="subGoodsItem" wx:for-index="subGoodsIndex" wx:key="subGoodsIndex"><block wx:if="{{subGoodsItem.form&&subGoodsItem.form.id==goodsItem.form.id}}"><view class="dir-left-nowrap goods-item data-v-3a558e4c"><view class="box-grow-0 data-v-3a558e4c"><image class="goods-image data-v-3a558e4c" src="{{subGoodsItem.goods_attr.pic_url?subGoodsItem.goods_attr.pic_url:subGoodsItem.cover_pic}}"></image></view><view class="box-grow-1 data-v-3a558e4c"><view class="goods-name data-v-3a558e4c">{{subGoodsItem.name}}</view><view class="dir-left-wrap attr-list data-v-3a558e4c"><block wx:for="{{subGoodsItem.attr_list}}" wx:for-item="attrItem" wx:for-index="attrIndex" wx:key="attrIndex"><view class="attr-item data-v-3a558e4c">{{''+attrItem.attr_group_name+":"+attrItem.attr_name+''}}</view></block></view><view class="dir-left-nowrap data-v-3a558e4c"><view class="box-grow-1 goods-num data-v-3a558e4c">{{"×"+subGoodsItem.num}}</view><view class="{{['box-grow-0 goods-price-info data-v-3a558e4c',theme+'-color']}}"><view class="data-v-3a558e4c"><block wx:for="{{subGoodsItem.custom_currency}}" wx:for-item="customCurrency" wx:for-index="customCurrencyIndex" wx:key="customCurrencyIndex"><text class="data-v-3a558e4c">{{''+customCurrency+'+'}}</text></block><text class="goods-price-unit data-v-3a558e4c">￥</text><text class="data-v-3a558e4c">{{subGoodsItem.total_original_price}}</text></view><block wx:for="{{subGoodsItem.discounts}}" wx:for-item="discount" wx:for-index="discountIndex" wx:key="discountIndex"><view class="data-v-3a558e4c">{{''+discount.name+": "+discount.value+''}}</view></block></view></view></view></view></block></block></view></block><app-diy-form vue-id="{{('16-'+mchIndex+'-'+goodsIndex)+','+('1')}}" list="{{goodsItem.form.value}}" sign="{{mchIndex+','+goodsIndex+','+goodsItem.form.id}}" data-event-opts="{{[['^input',[['handleGoodsFormInput']]],['^validate',[['handleGoodsFormValidate']]]]}}" bind:input="__e" bind:validate="__e" class="data-v-3a558e4c" bind:__l="__l"></app-diy-form></view></block></block></block></view></block></view></view></block><view class="data-v-3a558e4c"><block wx:if="{{previewData}}"><view class="submit-bar dir-left-nowrap data-v-3a558e4c"><view class="{{['box-grow-1 cross-center order-info data-v-3a558e4c',theme+'-color']}}"><view style="display:inline-block;" class="data-v-3a558e4c">{{totalTitle+":"}}</view><block wx:for="{{previewData.custom_currency_all}}" wx:for-item="custom_currency" wx:for-index="__i0__" wx:key="*this"><view style="display:inline-block;" class="data-v-3a558e4c">{{''+custom_currency+'+'}}</view></block><view style="display:inline-block;white-space:nowrap;" class="data-v-3a558e4c">{{"￥"+previewData.total_price+''}}<view style="content:'  ';display:inline-block;width:20rpx;" class="data-v-3a558e4c"></view></view></view><block wx:if="{{previewData.address_enable&&previewData.price_enable}}"><view data-event-opts="{{[['tap',[['subscribe',['$event']]]]]}}" class="{{['submit-btn box-grow-0 cross-center data-v-3a558e4c',theme+'-background',submitLock?'lock':'']}}" bindtap="__e"><view style="background-color:transparent;color:#ffffff;" class="data-v-3a558e4c">提交</view></view></block><block wx:else><block wx:if="{{!previewData.address_enable}}"><view class="{{['submit-btn box-grow-0 cross-center disabled data-v-3a558e4c',theme+'-background']}}"><view style="background-color:transparent;" class="data-v-3a558e4c">该地区无货</view></view></block><block wx:else><view class="{{['submit-btn box-grow-0 cross-center disabled data-v-3a558e4c',theme+'-background']}}"><view style="background-color:transparent;" class="data-v-3a558e4c">未达起送要求</view></view></block></block></view></block></view></app-layout>